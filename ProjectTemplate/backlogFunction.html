<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>
        // Notes: This is the page that haven't been used
        //this function grabs accounts and loads our account window
        function LoadAccounts() {
            var webMethod = "ProjectServices.asmx/GetAccounts";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        //let's put our accounts that we get from the
                        //server into our accountsArray variable
                        //so we can use them in other functions as well
                        accountsArray = msg.d;
                        //this clears out the div that will hold our account info
                        $("#accountsBox").empty();
                        //again, we assume we're not an admin unless we see data from the server
                        //that we know only admins can see
                        admin = false;
                        for (var i = 0; i < accountsArray.length; i++) {
                            //we grab on to a specific html element in jQuery
                            //by using a  # followed by that element's id.
                            var acct;
                            //if they have access to admin-level info (like userid and password) then
                            //create output that has an edit option
                            if (accountsArray[i].userId != null) {
                                acct = "<div class='accountRow' id='acct" + accountsArray[i].id + "'>" +
                                    "<a class='nameTag' href='mailto:" + accountsArray[i].email + "'>" +
                                    accountsArray[i].firstName + " " + accountsArray[i].lastName +
                                    "</a> <a href='#' onclick='LoadAccount(" + accountsArray[i].id+")' class='optionsTag'>edit</a></div><hr>"
                                admin = true;
                            }
                            //if not, then they're not an admin so don't include the edit option
                            else {
                                acct = "<div class='accountRow' id='acct" + accountsArray[i].id + "'>" +
                                    "<a class='nameTag' href='mailto:" + accountsArray[i].email + "'>" +
                                    accountsArray[i].firstName + " " + accountsArray[i].lastName +
                                    "</a></div><hr>"
                            }
                            $("#accountsBox").append(
                                //anything we throw at our panel in the form of text
                                //will be added to the contents of that panel.  Here
                                //we're putting together a div that holds info on the
                                //account as well as an edit link if the user is an admin
                                acct
                            );
                        }
                    }
                    //we're showing the account window, so let's track that...
                    accountWindowShowing = true;
                    //...because the ShowMenu function behaves differently depending on
                    //if the account window is showing or not
                    ShowMenu();
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //this is just like loading accounts!
        function LoadRequests() {
            var webMethod = "ProjectServices.asmx/GetAccountRequests";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        $("#requestsBox").empty();
                        admin = false;
                        for (var i = 0; i < msg.d.length; i++) {
                            req = "<div class='accountRow' id='acctR" + msg.d[i].id + "'>" +
                                "<span class='nameTag'>" +
                                msg.d[i].firstName + " " + msg.d[i].lastName +
                                "</span> <span class='optionsTag'><a href='#' onclick='approveAccount(" + msg.d[i].id + ")'>yes</a> / " +
                                "<a href='#' onclick='rejectAccount(" + msg.d[i].id + ")'>no</a></span>" +
                                "<div style='font-size: smaller'>" + msg.d[i].email + "</div></div > <hr>";
                            $("#requestsBox").append(req);
                        }
                    }
                    accountWindowShowing = false;
                    ShowMenu();
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //a simple ajax call that passes the id to be approved
        function approveAccount(id) {
            var webMethod = "ProjectServices.asmx/ActivateAccount";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    showPanel('requestsPanel');
                    LoadRequests();
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }

        //virtually identical with approve
        function rejectAccount(id) {
            var webMethod = "ProjectServices.asmx/RejectAccount";
            var parameters = "{\"id\":\"" + encodeURI(id) + "\"}";

            $.ajax({
                type: "POST",
                url: webMethod,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    showPanel('requestsPanel');
                    LoadRequests();
                },
                error: function (e) {
                    alert("boo...");
                }
            });
        }
    </script>
</head>
<body>

<!--choosingAvatar after dashboard-->
<div id="avatarChoosingPanel">
    <div class="avatarBox">
        <h1>Choose Your Avatar</h1>
        <table class="alienOptions">
            <!-- Aliens -->
            <tr>
                <td>
                    <div>
                        <label id="alien1" for="a1">
                            <div><img src="" width="500" alt="Alien 1"></div>
                        </label>
                        <input type="radio" name="alienChosen" id="a1" value="" class="">
                    </div>
                </td>
                <td>
                    <div>
                        <label id="alien2" for="a2">
                            <div><img src="" width="500" alt="Alien 2"></div>
                        </label>
                        <input type="radio" name="alienChosen" id="a2" value="" class="">
                    </div>
                </td>
                <td>
                    <div>
                        <label id="alien3" for="a3">
                            <div><img src="" width="500" alt="Alien 3"></div>
                        </label>
                        <input type="radio" name="alienChosen" id="a3" value="" class="">
                    </div>
                </td>
            </tr>
            <!-- Name -->
            <tr>
                <td>
                    <div>
                        <label for="alienName">
                            Give your alien a name:
                        </label>
                        <input type="text" id="alienName">
                    </div>
                </td>
            </tr>

            <!-- Submit -->
            <tr>
                <td colspan="3">
                    <!--						<input type="submit" id="submit"-->
                    <!--							   value="Click to blast off!">-->
                    <br><button>Click to blast off!</button>
                </td>
            </tr>
        </table>
    </div>
</div>

<!--request page viewed by Administration-->
<div id="requestsPanel" class="contentPanel">
    <div class="left">Account requests</div>
    <hr />
    <div class="accountsBox" id="requestsBox">
    </div>
</div>

<!--edit page for Administration-->
<div id="editAccountPanel" class="contentPanel newAccountPanel">
    <div class="newAccountBox">
        <form onsubmit="EditAccount(); return false;">
            <div class="left">Edit Account</div>
            <div><a href="#" onclick="DeactivateAccount()" class="tinyLink">...or deactivate</a></div>
            <hr />
            <div>
                ID: <input type="text" id="editLogonId" />
            </div>
            <div>
                Pwd: <input type="password" id="editLogonPassword" />
            </div>
            <div>
                First: <input type="text" id="editLogonFName" />
            </div>
            <div>
                Last: <input type="text" id="editLogonLName" />
            </div>
            <div>
                Email: <input type="text" id="editLogonEmail" />
            </div>
            <hr />
            <div>
                <button type="submit">Save</button>
            </div>
        </form>

    </div>
</div>

</body>
</html>
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Avatar_Wonderland</title>
	<!--DO NOT FORGET THIS SCRIPT TAG SO YOU CAN USE JQUERY!!!!!-->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!--	<script type="text/javascript" src="frontendProcessing.js"></script>-->
	<script>

		//resets the logon inputs
		function clearLogon() {
			$('#logonId').val("");
			$('#logonPassword').val("");
		}
		function TestButtonHandler() {
			var webMethod = "ProjectServices.asmx/TestConnection";
			var parameters = "{}";

			//jQuery ajax method
			$.ajax({
				type: "POST",
				url: webMethod,
				data: parameters,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function (msg) {
					var responseFromServer = msg.d;
					alert(responseFromServer);
				},
				error: function (e) {
					alert("this code will only execute if javascript is unable to access the webservice");
				}
			});
		}
		function LogOn(userId, pass) {
			var webMethod = "ProjectServices.asmx/LogOn";
			var parameters = "{\"uid\":\"" + encodeURI(userId) + "\",\"pass\":\"" + encodeURI(pass) + "\"}";

			//jQuery ajax method
			$.ajax({
				type: "POST",
				url: webMethod,
				data: parameters,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function (msg) {
					if (msg.d) {
						//server replied true, so direct the user to the dashboard
						window.open('dashboard.html', '_self')
						// TODO: remove the munu function and add a log off button instead
						// ShowMenu();
					}
					else {
						alert("logon failed");
					}
				},
				error: function (e) {
					alert("boo...");
				}
			});
		}

		//logs the user off both at the client and at the server
		function LogOff() {

			var webMethod = "ProjectServices.asmx/LogOff";
			$.ajax({
				type: "POST",
				url: webMethod,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function (msg) {
					if (msg.d) {
						//we logged off, so go back to logon page,
						//stop checking messages
						//and clear the chat panel
						showPanel('logonPanel');
						HideMenu();
					}
					else {
					}
				},
				error: function (e) {
					alert("boo...");
				}
			});
		}
	</script>
	<link href="style.css" rel="stylesheet">
</head >
<body>
	<button onclick="javascript: TestButtonHandler();">Click here to test connection!</button>
	<div>
		<span><h1>Welcome to Alien Wonderland</h1></span>
		<div id="menu" class="menu">
			<a href="#" id="adminLink" onclick="adminClick()"></a>
			<a href="#" onclick="LogOff()">log off</a>
		</div>
	</div>

	<div id="logonPanel" class="logonPanel">
		<div class="logonBox">
			<form onsubmit="LogOn($('#logonId').val(), $('#logonPassword').val()); return false;">
				<div class="left"><h2>Logon</h2></div>
				<div><a href='requestAccount.html' class="tinyLink">...or request an account</a></div>
				<br><hr />
				<div>
					ID: <input type="text" id="logonId" />
				</div>
				<div>
					Pwd: <input type="password" id="logonPassword" />
				</div>
				<hr /><br>
				<div>
					<button class="goButton" type="submit">Go!</button>
				</div>
			</form>

		</div>	
	</div>
</body>
</html >
